############################
## WebTransaction Configuration
 ############################
 
#Job File Name Configuration
storehub.job-file-name=WebTransactionStgDBToFile.xml
 
#Reader Configuration 
xhub.webtransaction.querytimeout=5400
														
webTransactionStgDbToFileJob.webTransPartitioner.table=XHUB_STG_POS_TRANS_HEADER WITH (NOLOCK)

## ANSI
webTransactionStgDbToFileJob.webTransRelateReader.sql=\
	SELECT \
		STG_HEADER_ID, TRANSACTION_TYPE, MESSAGE_TYPE, LINE_SEQ_NUM, TAX_EXEMPT_ID, LINE_START_TIME, LINE_END_TIME, \
		CURRENCY_ID, REASON_CODE, TAX_GROUP_ID, TAX_AMT, VOID_FLAG, TAXABLE_AMT, TAX_PCT, \
		TAX_EXEMPT_AMT, TAX_LOC_ID, TAX_RULE_SEQ, TAX_AUTH_ID, TAX_AUTH_NAME, TAX_AUTH_TYPE_CODE, FL_TAX_OVERRIDE, \
		TAX_OVERRIDE_AMT, TAX_OVERRIDE_PCT, TAX_OVERRIDE_REASON_CODE, POSTAL_CODE, CITY, VD_REASON_CODE, \
		ORGANIZATION_ID, STORE_ID, DY_BSN, REG_ID, TRN_SEQ_NUM, TR_BEGIN_TIME, TR_END_TIME, TY_TRN, \
		TRN_STS, TILL_SESSION_ID, CASH_DRAWER_ID, OPERATOR_ID, SUB_TOTAL, TOTAL, \
		CUSTOMER_PARTY_ID, CANCEL_REASON_CODE, ORD_REF_NUMBER, STG_EVENT_ID, STG_RELATE_RUN_ID, STG_POS_RUN_ID, \
		ORG_STORE_ID, ORG_DY_BSN, ORG_REG_ID, ORG_TRN_SEQ_NUM, LINE_ITEM_TYPE, ITEM_ID, ITEM_SERIAL_NO, \
		ITEM_QTY, ITEM_TYPE, UNIT_COST, UNIT_RTL_PRC, EXTND_NET_AMT, TTL_LN_ITM_AMT, RETURN_FLAG, \
		COMM_PERCENTAGE_ITEM, EMPLOYEE_ID, DOCUMENT_TYPE, DOCUMENT_ID, ACTIVITY_CODE, SERIES_ID, ORD_REF_LINE_SEQ, TAX_LINE_ITEM, CUST_EXEMPT_ID, AMOUNT_ACTION, AMOUNT, PROMOTION_ID, REASON_CODE_COMMENT, COUPON_SCAN_CODE, \
		LOYALTY_CARD_NO, TENDER_ID, TENDER_AMT, SERIAL_NUMBER, TENDER_STATUS_CODE, CHANGE_FLAG, HOST_VALIDATION_FLAG, APPROVAl_CODE, \
		ADJUDICATION_CODE, FOREIGN_AMOUNT, FACE_VALUE_AMT, EXPIRY_DATE, UNSPENT_BAL_AMT, DATE_SOLD, ACCT_USER_NAME, TENDER_TYPE \
	FROM ( \
		SELECT \
			H.STG_HEADER_ID AS STG_HEADER_ID, H.TRANSACTION_TYPE AS TRANSACTION_TYPE, H.MESSAGE_TYPE AS MESSAGE_TYPE, NULL AS LINE_SEQ_NUM, \
			H.TAX_EXEMPT_ID AS TAX_EXEMPT_ID, NULL AS LINE_START_TIME, NULL AS LINE_END_TIME, NULL AS CURRENCY_ID, NULL AS REASON_CODE, \
			NULL AS TAX_GROUP_ID, H.TAX_AMT AS TAX_AMT, H.POST_VOID_FLAG AS VOID_FLAG, NULL AS TAXABLE_AMT, NULL AS TAX_PCT, NULL AS TAX_EXEMPT_AMT, \
			NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, NULL AS TAX_AUTH_ID, NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, NULL AS FL_TAX_OVERRIDE, \
			NULL AS TAX_OVERRIDE_AMT, NULL AS TAX_OVERRIDE_PCT, NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, NULL AS CITY, \
			NULL AS VD_REASON_CODE, H.ORGANIZATION_ID AS ORGANIZATION_ID, H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, \
			H.TRN_SEQ_NUM AS TRN_SEQ_NUM, H.TR_BEGIN_TIME AS TR_BEGIN_TIME, H.TR_END_TIME AS TR_END_TIME, H.TY_TRN AS TY_TRN, H.TRN_STS AS TRN_STS, \
			H.TILL_SESSION_ID AS TILL_SESSION_ID, H.CASH_DRAWER_ID AS CASH_DRAWER_ID, H.OPERATOR_ID AS OPERATOR_ID, H.SUB_TOTAL AS SUB_TOTAL, \
			H.TOTAL AS TOTAL, H.CUSTOMER_PARTY_ID AS CUSTOMER_PARTY_ID, H.CANCEL_REASON_CODE AS CANCEL_REASON_CODE, H.ORD_REF_NUMBER AS ORD_REF_NUMBER, H.STG_EVENT_ID AS STG_EVENT_ID, \
			H.STG_RELATE_RUN_ID AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, \
			NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, \
			NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, \
			NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, NULL AS ACTIVITY_CODE, \
			NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, NULL AS PROMOTION_ID, \
			NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, \
			NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, \
			NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, \
			NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_RELATE_STATUS = 0 AND H.STG_RELATE_PROCESS_DATE IS NULL) OR (H.STG_RELATE_STATUS = 2 AND H.STG_RELATE_PROCESS_DATE IS NOT NULL) AND H.ORGANIZATION_ID=?) \
		UNION \
		SELECT \
			L.STG_HEADER_ID AS STG_HEADER_ID, L.TRANSACTION_TYPE AS TRANSACTION_TYPE, L.MESSAGE_TYPE AS MESSAGE_TYPE, L.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, L.LINE_START_TIME LINE_START_TIME, L.LINE_END_TIME AS LINE_END_TIME, L.CURRENCY_ID AS CURRENCY_ID, \
			L.REASON_CODE AS REASON_CODE, L.TAX_GROUP_ID AS TAX_GROUP_ID, NULL AS TAX_AMT, L.FL_VD_LN_ITM AS VOID_FLAG, \
			NULL AS TAXABLE_AMT, NULL AS TAX_PCT, NULL AS TAX_EXEMPT_AMT, NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, NULL AS TAX_AUTH_ID, \
			NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, NULL AS FL_TAX_OVERRIDE, NULL AS TAX_OVERRIDE_AMT, NULL AS TAX_OVERRIDE_PCT, \
			NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, NULL AS CITY, NULL AS VD_REASON_CODE, NULL AS ORGANIZATION_ID, \
			H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, \
			NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, \
			NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, L.ORD_REF_NUMBER AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, \
			L.ORG_STORE_ID AS ORG_STORE_ID, L.ORG_DY_BSN AS ORG_DY_BSN, L.ORG_REG_ID AS ORG_REG_ID, L.ORG_TRN_SEQ_NUM AS ORG_TRN_SEQ_NUM, \
			L.LINE_ITEM_TYPE AS LINE_ITEM_TYPE, L.ITEM_ID AS ITEM_ID, L.ITEM_SERIAL_NO AS ITEM_SERIAL_NO, L.ITEM_QTY AS ITEM_QTY, \
			L.ITEM_TYPE AS ITEM_TYPE, L.UNIT_COST AS UNIT_COST, L.UNIT_RTL_PRC AS UNIT_RTL_PRC, L.EXTND_NET_AMT AS EXTND_NET_AMT, \
			L.TTL_LN_ITM_AMT AS TTL_LN_ITM_AMT, L.RETURN_FLAG AS RETURN_FLAG, L.COMM_PERCENTAGE_ITEM AS COMM_PERCENTAGE_ITEM, \
			L.EMPLOYEE_ID AS EMPLOYEE_ID, L.DOCUMENT_TYPE AS DOCUMENT_TYPE, L.DOCUMENT_ID AS DOCUMENT_ID, L.ACTIVITY_CODE AS ACTIVITY_CODE, \
			L.SERIES_ID AS SERIES_ID, L.ORD_REF_LINE_SEQ AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, NULL AS PROMOTION_ID, \
			NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, \
			NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, \
			NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, \
			NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_LINE_ITEM L, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_RELATE_STATUS = 0 AND H.STG_RELATE_PROCESS_DATE IS NULL) OR (H.STG_RELATE_STATUS = 2 AND H.STG_RELATE_PROCESS_DATE IS NOT NULL)) \
		AND L.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			LT.STG_HEADER_ID AS STG_HEADER_ID, LT.TRANSACTION_TYPE AS TRANSACTION_TYPE, LT.MESSAGE_TYPE AS MESSAGE_TYPE, LT.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			LT.TAX_EXEMPT_ID AS TAX_EXEMPT_ID, NULL AS LINE_START_TIME, NULL AS LINE_END_TIME, NULL AS CURRENCY_ID, NULL AS REASON_CODE, \
			LT.TAX_GROUP_ID AS TAX_GROUP_ID, LT.TAX_AMT AS TAX_AMT, LT.VOID_FLAG AS VOID_FLAG, LT.TAXABLE_AMT AS TAXABLE_AMT, LT.TAX_PCT AS TAX_PCT, \
			LT.TAX_EXEMPT_AMT AS TAX_EXEMPT_AMT, LT.TAX_LOC_ID AS TAX_LOC_ID, LT.TAX_RULE_SEQ AS TAX_RULE_SEQ, LT.TAX_AUTH_ID AS TAX_AUTH_ID, \
			LT.TAX_AUTH_NAME AS TAX_AUTH_NAME, LT.TAX_AUTH_TYPE_CODE AS TAX_AUTH_TYPE_CODE, LT.FL_TAX_OVERRIDE AS FL_TAX_OVERRIDE, \
			LT.TAX_OVERRIDE_AMT AS TAX_OVERRIDE_AMT, LT.TAX_OVERRIDE_PCT AS TAX_OVERRIDE_PCT, LT.TAX_OVERRIDE_REASON_CODE AS TAX_OVERRIDE_REASON_CODE, \
			LT.POSTAL_CODE AS POSTAL_CODE, LT.CITY AS CITY, NULL AS VD_REASON_CODE, NULL AS ORGANIZATION_ID, \
			H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, \
			NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, \
			NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, \
			NULL AS STG_POS_RUN_ID, NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, \
			NULL AS ITEM_ID, NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, \
			NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, \
			NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, LT.TAX_LINE_ITEM AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, \
			NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, \
			NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, \
			NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, NULL AS DATE_SOLD, \
			NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_LN_ITM_TAX LT, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_RELATE_STATUS = 0 AND H.STG_RELATE_PROCESS_DATE IS NULL) OR (H.STG_RELATE_STATUS = 2 AND H.STG_RELATE_PROCESS_DATE IS NOT NULL)) \
		AND LT.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			LD.STG_HEADER_ID AS STG_HEADER_ID, LD.TRANSACTION_TYPE AS TRANSACTION_TYPE, LD.MESSAGE_TYPE AS MESSAGE_TYPE, LD.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, NULL AS LINE_START_TIME, NULL AS LINE_END_TIME, NULL AS CURRENCY_ID, LD.REASON_CODE AS REASON_CODE, NULL AS TAX_GROUP_ID, \
			NULL AS TAX_AMT, NULL AS VOID_FLAG, NULL AS TAXABLE_AMT, NULL AS TAX_PCT, NULL AS TAX_EXEMPT_AMT, NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, \
			NULL AS TAX_AUTH_ID, NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, NULL AS FL_TAX_OVERRIDE, NULL AS TAX_OVERRIDE_AMT, \
			NULL AS TAX_OVERRIDE_PCT, NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, NULL AS CITY, NULL AS VD_REASON_CODE, \
			NULL AS ORGANIZATION_ID, H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, \
			NULL AS TR_END_TIME, NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, \
			NULL AS TOTAL, NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, \
			NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, \
			NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, \
			NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, \
			NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, LD.AMOUNT_ACTION AS AMOUNT_ACTION, \
			LD.AMOUNT AS AMOUNT, LD.PROMOTION_ID AS PROMOTION_ID, LD.REASON_CODE_COMMENT AS REASON_CODE_COMMENT, LD.COUPON_SCAN_CODE AS COUPON_SCAN_CODE, \
			LD.LOYALTY_CARD_NO AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, \
			NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, \
			NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_DISCOUNT_LINEITEM LD, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_RELATE_STATUS = 0 AND H.STG_RELATE_PROCESS_DATE IS NULL) OR (H.STG_RELATE_STATUS = 2 AND H.STG_RELATE_PROCESS_DATE IS NOT NULL)) \
		AND LD.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			TT.STG_HEADER_ID AS STG_HEADER_ID, TT.TRANSACTION_TYPE AS TRANSACTION_TYPE, TT.MESSAGE_TYPE AS MESSAGE_TYPE, TT.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, TT.LINE_START_TIME AS LINE_START_TIME, TT.LINE_END_TIME AS LINE_END_TIME, TT.CURRENCY_ID AS CURRENCY_ID, \
			NULL AS REASON_CODE, TT.TAX_GROUP_ID AS TAX_GROUP_ID, TT.TAX_AMT AS TAX_AMT, TT.VOID_FLAG AS VOID_FLAG, TT.TAXABLE_AMT AS TAXABLE_AMT, \
			TT.TAX_PCT AS TAX_PCT, TT.TAX_EXEMPT_AMT AS TAX_EXEMPT_AMT, TT.TAX_LOC_ID AS TAX_LOC_ID, TT.TAX_RULE_SEQ AS TAX_RULE_SEQ, \
			TT.TAX_AUTH_ID AS TAX_AUTH_ID, TT.TAX_AUTH_NAME AS TAX_AUTH_NAME, TT.TAX_AUTH_TYPE_CODE AS TAX_AUTH_TYPE_CODE, \
			TT.FL_TAX_OVERRIDE AS FL_TAX_OVERRIDE, TT.TAX_OVERRIDE_AMT AS TAX_OVERRIDE_AMT, TT.TAX_OVERRIDE_PCT AS TAX_OVERRIDE_PCT, \
			TT.TAX_OVERRIDE_REASON_CODE AS TAX_OVERRIDE_REASON_CODE, TT.POSTAL_CODE AS POSTAL_CODE, TT.CITY AS CITY, TT.VD_REASON_CODE AS VD_REASON_CODE, \
			NULL AS ORGANIZATION_ID, H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, \
			NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, \
			NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, \
			NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, \
			NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, \
			NULL AS EXTND_NET_AMT, NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, \
			NULL AS DOCUMENT_ID, NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, TT.CUST_EXEMPT_ID AS CUST_EXEMPT_ID, \
			NULL AS AMOUNT_ACTION, NULL AS AMOUNT, NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, \
			NULL AS TENDER_ID, NULL AS TENDER_AMT, NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, \
			NULL AS APPROVAl_CODE, NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, \
			NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_TAX TT, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_RELATE_STATUS = 0 AND H.STG_RELATE_PROCESS_DATE IS NULL) OR (H.STG_RELATE_STATUS = 2 AND H.STG_RELATE_PROCESS_DATE IS NOT NULL)) \
		AND TT.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			TN.STG_HEADER_ID AS STG_HEADER_ID, TN.TRANSACTION_TYPE AS TRANSACTION_TYPE, TN.MESSAGE_TYPE AS MESSAGE_TYPE, TN.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, TN.LINE_START_TIME AS LINE_START_TIME, TN.LINE_END_TIME AS LINE_END_TIME, TN.CURRENCY_ID AS CURRENCY_ID, \
			NULL AS REASON_CODE, NULL AS TAX_GROUP_ID, NULL AS TAX_AMT, TN.FL_VD_LN_ITM AS VOID_FLAG, NULL AS TAXABLE_AMT, NULL AS TAX_PCT, \
			NULL AS TAX_EXEMPT_AMT, NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, NULL AS TAX_AUTH_ID, NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, \
			NULL AS FL_TAX_OVERRIDE, NULL AS TAX_OVERRIDE_AMT, NULL AS TAX_OVERRIDE_PCT, NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, \
			NULL AS CITY, TN.VD_REASON_CODE AS VD_REASON_CODE, NULL AS ORGANIZATION_ID, \
			H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, \
			NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, \
			NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, \
			NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, \
			NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, \
			NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, \
			NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, \
			NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, TN.TENDER_ID AS TENDER_ID, \
			TN.TENDER_AMT AS TENDER_AMT, TN.SERIAL_NUMBER AS SERIAL_NUMBER, TN.TENDER_STATUS_CODE AS TENDER_STATUS_CODE, TN.CHANGE_FLAG AS CHANGE_FLAG, \
			TN.HOST_VALIDATION_FLAG AS HOST_VALIDATION_FLAG, TN.APPROVAl_CODE AS APPROVAl_CODE, TN.ADJUDICATION_CODE AS ADJUDICATION_CODE, \
			TN.FOREIGN_AMOUNT AS FOREIGN_AMOUNT, TN.FACE_VALUE_AMT AS FACE_VALUE_AMT, TN.EXPIRY_DATE AS EXPIRY_DATE, TN.UNSPENT_BAL_AMT AS UNSPENT_BAL_AMT, \
			TN.DATE_SOLD AS DATE_SOLD, TN.ACCT_USER_NAME AS ACCT_USER_NAME, TN.TENDER_TYPE AS TENDER_TYPE \
		FROM XHUB_STG_POS_TENDER_LINEITEM TN, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_RELATE_STATUS = 0 AND H.STG_RELATE_PROCESS_DATE IS NULL) OR (H.STG_RELATE_STATUS = 2 AND H.STG_RELATE_PROCESS_DATE IS NOT NULL)) \
		AND TN.STG_HEADER_ID = H.STG_HEADER_ID 	AND H.ORGANIZATION_ID=?	\
		) T \
	ORDER BY STG_HEADER_ID

## ANSI
webTransactionStgDbToFileJob.webTransactionXstoreReader.sql=\
	SELECT \
		STG_HEADER_ID, TRANSACTION_TYPE, MESSAGE_TYPE, LINE_SEQ_NUM, TAX_EXEMPT_ID, LINE_START_TIME, LINE_END_TIME, \
		CURRENCY_ID, REASON_CODE, TAX_GROUP_ID, TAX_AMT, VOID_FLAG, TAXABLE_AMT, TAX_PCT, \
		TAX_EXEMPT_AMT, TAX_LOC_ID, TAX_RULE_SEQ, TAX_AUTH_ID, TAX_AUTH_NAME, TAX_AUTH_TYPE_CODE, FL_TAX_OVERRIDE, \
		TAX_OVERRIDE_AMT, TAX_OVERRIDE_PCT, TAX_OVERRIDE_REASON_CODE, POSTAL_CODE, CITY, VD_REASON_CODE, \
		ORGANIZATION_ID, STORE_ID, DY_BSN, REG_ID, TRN_SEQ_NUM, TR_BEGIN_TIME, TR_END_TIME, TY_TRN, \
		TRN_STS, TILL_SESSION_ID, CASH_DRAWER_ID, OPERATOR_ID, SUB_TOTAL, TOTAL, \
		CUSTOMER_PARTY_ID, CANCEL_REASON_CODE, ORD_REF_NUMBER, STG_EVENT_ID, STG_RELATE_RUN_ID, STG_POS_RUN_ID, \
		ORG_STORE_ID, ORG_DY_BSN, ORG_REG_ID, ORG_TRN_SEQ_NUM, LINE_ITEM_TYPE, ITEM_ID, ITEM_SERIAL_NO, \
		ITEM_QTY, ITEM_TYPE, UNIT_COST, UNIT_RTL_PRC, EXTND_NET_AMT, TTL_LN_ITM_AMT, RETURN_FLAG, \
		COMM_PERCENTAGE_ITEM, EMPLOYEE_ID, DOCUMENT_TYPE, DOCUMENT_ID, ACTIVITY_CODE, SERIES_ID, ORD_REF_LINE_SEQ, TAX_LINE_ITEM, CUST_EXEMPT_ID, AMOUNT_ACTION, AMOUNT, PROMOTION_ID, REASON_CODE_COMMENT, COUPON_SCAN_CODE, \
		LOYALTY_CARD_NO, TENDER_ID, TENDER_AMT, SERIAL_NUMBER, TENDER_STATUS_CODE, CHANGE_FLAG, HOST_VALIDATION_FLAG, APPROVAl_CODE, \
		ADJUDICATION_CODE, FOREIGN_AMOUNT, FACE_VALUE_AMT, EXPIRY_DATE, UNSPENT_BAL_AMT, DATE_SOLD, ACCT_USER_NAME, TENDER_TYPE \
	FROM ( \
		SELECT \
			H.STG_HEADER_ID AS STG_HEADER_ID, H.TRANSACTION_TYPE AS TRANSACTION_TYPE, H.MESSAGE_TYPE AS MESSAGE_TYPE, NULL AS LINE_SEQ_NUM, \
			H.TAX_EXEMPT_ID AS TAX_EXEMPT_ID, NULL AS LINE_START_TIME, NULL AS LINE_END_TIME, NULL AS CURRENCY_ID, NULL AS REASON_CODE, \
			NULL AS TAX_GROUP_ID, H.TAX_AMT AS TAX_AMT, H.POST_VOID_FLAG AS VOID_FLAG, NULL AS TAXABLE_AMT, NULL AS TAX_PCT, NULL AS TAX_EXEMPT_AMT, \
			NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, NULL AS TAX_AUTH_ID, NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, NULL AS FL_TAX_OVERRIDE, \
			NULL AS TAX_OVERRIDE_AMT, NULL AS TAX_OVERRIDE_PCT, NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, NULL AS CITY, \
			NULL AS VD_REASON_CODE, H.ORGANIZATION_ID AS ORGANIZATION_ID, H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, \
			H.TRN_SEQ_NUM AS TRN_SEQ_NUM, H.TR_BEGIN_TIME AS TR_BEGIN_TIME, H.TR_END_TIME AS TR_END_TIME, H.TY_TRN AS TY_TRN, H.TRN_STS AS TRN_STS, \
			H.TILL_SESSION_ID AS TILL_SESSION_ID, H.CASH_DRAWER_ID AS CASH_DRAWER_ID, H.OPERATOR_ID AS OPERATOR_ID, H.SUB_TOTAL AS SUB_TOTAL, \
			H.TOTAL AS TOTAL, H.CUSTOMER_PARTY_ID AS CUSTOMER_PARTY_ID, H.CANCEL_REASON_CODE AS CANCEL_REASON_CODE, H.ORD_REF_NUMBER AS ORD_REF_NUMBER ,H.STG_EVENT_ID AS STG_EVENT_ID, \
			NULL AS STG_RELATE_RUN_ID, H.STG_POS_RUN_ID AS STG_POS_RUN_ID, NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, \
			NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, \
			NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, \
			NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, \
			NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, \
			NULL AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, \
			NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, \
			NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_POS_STATUS = 0 AND H.STG_POS_PROCESS_DATE IS NULL) OR (H.STG_POS_STATUS = 2 AND H.STG_POS_PROCESS_DATE IS NOT NULL) AND H.ORGANIZATION_ID=?) \
		UNION \
		SELECT \
			L.STG_HEADER_ID AS STG_HEADER_ID, L.TRANSACTION_TYPE AS TRANSACTION_TYPE, L.MESSAGE_TYPE AS MESSAGE_TYPE, L.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, L.LINE_START_TIME LINE_START_TIME, L.LINE_END_TIME AS LINE_END_TIME, L.CURRENCY_ID AS CURRENCY_ID, \
			L.REASON_CODE AS REASON_CODE, L.TAX_GROUP_ID AS TAX_GROUP_ID, NULL AS TAX_AMT, L.FL_VD_LN_ITM AS VOID_FLAG, \
			NULL AS TAXABLE_AMT, NULL AS TAX_PCT, NULL AS TAX_EXEMPT_AMT, NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, NULL AS TAX_AUTH_ID, \
			NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, NULL AS FL_TAX_OVERRIDE, NULL AS TAX_OVERRIDE_AMT, NULL AS TAX_OVERRIDE_PCT, \
			NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, NULL AS CITY, NULL AS VD_REASON_CODE, NULL AS ORGANIZATION_ID, \
			H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, \
			NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, \
			NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, L.ORD_REF_NUMBER AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, \
			L.ORG_STORE_ID AS ORG_STORE_ID, L.ORG_DY_BSN AS ORG_DY_BSN, L.ORG_REG_ID AS ORG_REG_ID, L.ORG_TRN_SEQ_NUM AS ORG_TRN_SEQ_NUM, \
			L.LINE_ITEM_TYPE AS LINE_ITEM_TYPE, L.ITEM_ID AS ITEM_ID, L.ITEM_SERIAL_NO AS ITEM_SERIAL_NO, L.ITEM_QTY AS ITEM_QTY, L.ITEM_TYPE AS ITEM_TYPE, \
			L.UNIT_COST AS UNIT_COST, L.UNIT_RTL_PRC AS UNIT_RTL_PRC, L.EXTND_NET_AMT AS EXTND_NET_AMT, L.TTL_LN_ITM_AMT AS TTL_LN_ITM_AMT, \
			L.RETURN_FLAG AS RETURN_FLAG, L.COMM_PERCENTAGE_ITEM AS COMM_PERCENTAGE_ITEM, L.EMPLOYEE_ID AS EMPLOYEE_ID, L.DOCUMENT_TYPE AS DOCUMENT_TYPE, \
			L.DOCUMENT_ID AS DOCUMENT_ID, L.ACTIVITY_CODE AS ACTIVITY_CODE, L.SERIES_ID AS SERIES_ID, L.ORD_REF_LINE_SEQ AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, \
			NULL AS AMOUNT_ACTION, NULL AS AMOUNT, NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, \
			NULL AS TENDER_ID, NULL AS TENDER_AMT, NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, \
			NULL AS APPROVAl_CODE, NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, \
			NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_LINE_ITEM L, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_POS_STATUS = 0 AND H.STG_POS_PROCESS_DATE IS NULL) OR (H.STG_POS_STATUS = 2 AND H.STG_POS_PROCESS_DATE IS NOT NULL)) \
		AND L.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			LT.STG_HEADER_ID AS STG_HEADER_ID, LT.TRANSACTION_TYPE AS TRANSACTION_TYPE, LT.MESSAGE_TYPE AS MESSAGE_TYPE, LT.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			LT.TAX_EXEMPT_ID AS TAX_EXEMPT_ID, NULL AS LINE_START_TIME, NULL AS LINE_END_TIME, NULL AS CURRENCY_ID, NULL AS REASON_CODE, \
			LT.TAX_GROUP_ID AS TAX_GROUP_ID, LT.TAX_AMT AS TAX_AMT, LT.VOID_FLAG AS VOID_FLAG, LT.TAXABLE_AMT AS TAXABLE_AMT, LT.TAX_PCT AS TAX_PCT, \
			LT.TAX_EXEMPT_AMT AS TAX_EXEMPT_AMT, LT.TAX_LOC_ID AS TAX_LOC_ID, LT.TAX_RULE_SEQ AS TAX_RULE_SEQ, LT.TAX_AUTH_ID AS TAX_AUTH_ID, \
			LT.TAX_AUTH_NAME AS TAX_AUTH_NAME, LT.TAX_AUTH_TYPE_CODE AS TAX_AUTH_TYPE_CODE, LT.FL_TAX_OVERRIDE AS FL_TAX_OVERRIDE, \
			LT.TAX_OVERRIDE_AMT AS TAX_OVERRIDE_AMT, LT.TAX_OVERRIDE_PCT AS TAX_OVERRIDE_PCT, LT.TAX_OVERRIDE_REASON_CODE AS TAX_OVERRIDE_REASON_CODE, \
			LT.POSTAL_CODE AS POSTAL_CODE, LT.CITY AS CITY, NULL AS VD_REASON_CODE, NULL AS ORGANIZATION_ID, \
			H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, \
			NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, \
			NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, \
			NULL AS STG_POS_RUN_ID, NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, \
			NULL AS ITEM_ID, NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, \
			NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, \
			NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, LT.TAX_LINE_ITEM AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, \
			NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, \
			NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, \
			NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, NULL AS DATE_SOLD, \
			NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_LN_ITM_TAX LT, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_POS_STATUS = 0 AND H.STG_POS_PROCESS_DATE IS NULL) OR (H.STG_POS_STATUS = 2 AND H.STG_POS_PROCESS_DATE IS NOT NULL)) \
		AND LT.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			LD.STG_HEADER_ID AS STG_HEADER_ID, LD.TRANSACTION_TYPE AS TRANSACTION_TYPE, LD.MESSAGE_TYPE AS MESSAGE_TYPE, LD.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, NULL AS LINE_START_TIME, NULL AS LINE_END_TIME, NULL AS CURRENCY_ID, LD.REASON_CODE AS REASON_CODE, NULL AS TAX_GROUP_ID, \
			NULL AS TAX_AMT, NULL AS VOID_FLAG, NULL AS TAXABLE_AMT, NULL AS TAX_PCT, NULL AS TAX_EXEMPT_AMT, NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, \
			NULL AS TAX_AUTH_ID, NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, NULL AS FL_TAX_OVERRIDE, NULL AS TAX_OVERRIDE_AMT, \
			NULL AS TAX_OVERRIDE_PCT, NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, NULL AS CITY, NULL AS VD_REASON_CODE, \
			NULL AS ORGANIZATION_ID, H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, \
			NULL AS TR_END_TIME, NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, \
			NULL AS TOTAL, NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, \
			NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, \
			NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, \
			NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, \
			NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, LD.AMOUNT_ACTION AS AMOUNT_ACTION, \
			LD.AMOUNT AS AMOUNT, LD.PROMOTION_ID AS PROMOTION_ID, LD.REASON_CODE_COMMENT AS REASON_CODE_COMMENT, LD.COUPON_SCAN_CODE AS COUPON_SCAN_CODE, \
			LD.LOYALTY_CARD_NO AS LOYALTY_CARD_NO, NULL AS TENDER_ID, NULL AS TENDER_AMT, NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, \
			NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, NULL AS APPROVAl_CODE, NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, \
			NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_DISCOUNT_LINEITEM LD, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_POS_STATUS = 0 AND H.STG_POS_PROCESS_DATE IS NULL) OR (H.STG_POS_STATUS = 2 AND H.STG_POS_PROCESS_DATE IS NOT NULL)) \
		AND LD.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			TT.STG_HEADER_ID AS STG_HEADER_ID, TT.TRANSACTION_TYPE AS TRANSACTION_TYPE, TT.MESSAGE_TYPE AS MESSAGE_TYPE, TT.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, TT.LINE_START_TIME AS LINE_START_TIME, TT.LINE_END_TIME AS LINE_END_TIME, TT.CURRENCY_ID AS CURRENCY_ID, \
			NULL AS REASON_CODE, TT.TAX_GROUP_ID AS TAX_GROUP_ID, TT.TAX_AMT AS TAX_AMT, TT.VOID_FLAG AS VOID_FLAG, TT.TAXABLE_AMT AS TAXABLE_AMT, \
			TT.TAX_PCT AS TAX_PCT, TT.TAX_EXEMPT_AMT AS TAX_EXEMPT_AMT, TT.TAX_LOC_ID AS TAX_LOC_ID, TT.TAX_RULE_SEQ AS TAX_RULE_SEQ, \
			TT.TAX_AUTH_ID AS TAX_AUTH_ID, TT.TAX_AUTH_NAME AS TAX_AUTH_NAME, TT.TAX_AUTH_TYPE_CODE AS TAX_AUTH_TYPE_CODE, \
			TT.FL_TAX_OVERRIDE AS FL_TAX_OVERRIDE, TT.TAX_OVERRIDE_AMT AS TAX_OVERRIDE_AMT, TT.TAX_OVERRIDE_PCT AS TAX_OVERRIDE_PCT, \
			TT.TAX_OVERRIDE_REASON_CODE AS TAX_OVERRIDE_REASON_CODE, TT.POSTAL_CODE AS POSTAL_CODE, TT.CITY AS CITY, TT.VD_REASON_CODE AS VD_REASON_CODE, \
			NULL AS ORGANIZATION_ID, H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, \
			NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, \
			NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, \
			NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, \
			NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, \
			NULL AS EXTND_NET_AMT, NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, \
			NULL AS DOCUMENT_ID, NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, TT.CUST_EXEMPT_ID AS CUST_EXEMPT_ID, \
			NULL AS AMOUNT_ACTION, NULL AS AMOUNT, NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, \
			NULL AS TENDER_ID, NULL AS TENDER_AMT, NULL AS SERIAL_NUMBER, NULL AS TENDER_STATUS_CODE, NULL AS CHANGE_FLAG, NULL AS HOST_VALIDATION_FLAG, \
			NULL AS APPROVAl_CODE, NULL AS ADJUDICATION_CODE, NULL AS FOREIGN_AMOUNT, NULL AS FACE_VALUE_AMT, NULL AS EXPIRY_DATE, NULL AS UNSPENT_BAL_AMT, \
			NULL AS DATE_SOLD, NULL AS ACCT_USER_NAME, NULL AS TENDER_TYPE \
		FROM XHUB_STG_POS_TRANS_TAX TT, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_POS_STATUS = 0 AND H.STG_POS_PROCESS_DATE IS NULL) OR (H.STG_POS_STATUS = 2 AND H.STG_POS_PROCESS_DATE IS NOT NULL)) \
		AND TT.STG_HEADER_ID = H.STG_HEADER_ID AND H.ORGANIZATION_ID=? \
		UNION \
		SELECT \
			TN.STG_HEADER_ID AS STG_HEADER_ID, TN.TRANSACTION_TYPE AS TRANSACTION_TYPE, TN.MESSAGE_TYPE AS MESSAGE_TYPE, TN.LINE_SEQ_NUM AS LINE_SEQ_NUM, \
			NULL AS TAX_EXEMPT_ID, TN.LINE_START_TIME AS LINE_START_TIME, TN.LINE_END_TIME AS LINE_END_TIME, TN.CURRENCY_ID AS CURRENCY_ID, \
			NULL AS REASON_CODE, NULL AS TAX_GROUP_ID, NULL AS TAX_AMT, TN.FL_VD_LN_ITM AS VOID_FLAG, NULL AS TAXABLE_AMT, NULL AS TAX_PCT, \
			NULL AS TAX_EXEMPT_AMT, NULL AS TAX_LOC_ID, NULL AS TAX_RULE_SEQ, NULL AS TAX_AUTH_ID, NULL AS TAX_AUTH_NAME, NULL AS TAX_AUTH_TYPE_CODE, \
			NULL AS FL_TAX_OVERRIDE, NULL AS TAX_OVERRIDE_AMT, NULL AS TAX_OVERRIDE_PCT, NULL AS TAX_OVERRIDE_REASON_CODE, NULL AS POSTAL_CODE, \
			NULL AS CITY, TN.VD_REASON_CODE AS VD_REASON_CODE, NULL AS ORGANIZATION_ID, \
			H.STORE_ID AS STORE_ID, H.DY_BSN AS DY_BSN, H.REG_ID AS REG_ID, H.TRN_SEQ_NUM AS TRN_SEQ_NUM, NULL AS TR_BEGIN_TIME, NULL AS TR_END_TIME, \
			NULL AS TY_TRN, NULL AS TRN_STS, NULL AS TILL_SESSION_ID, NULL AS CASH_DRAWER_ID, NULL AS OPERATOR_ID, NULL AS SUB_TOTAL, NULL AS TOTAL, \
			NULL AS CUSTOMER_PARTY_ID, NULL AS CANCEL_REASON_CODE, NULL AS ORD_REF_NUMBER, NULL AS STG_EVENT_ID, NULL AS STG_RELATE_RUN_ID, NULL AS STG_POS_RUN_ID, \
			NULL AS ORG_STORE_ID, NULL AS ORG_DY_BSN, NULL AS ORG_REG_ID, NULL AS ORG_TRN_SEQ_NUM, NULL AS LINE_ITEM_TYPE, NULL AS ITEM_ID, \
			NULL AS ITEM_SERIAL_NO, NULL AS ITEM_QTY, NULL AS ITEM_TYPE, NULL AS UNIT_COST, NULL AS UNIT_RTL_PRC, NULL AS EXTND_NET_AMT, \
			NULL AS TTL_LN_ITM_AMT, NULL AS RETURN_FLAG, NULL AS COMM_PERCENTAGE_ITEM, NULL AS EMPLOYEE_ID, NULL AS DOCUMENT_TYPE, NULL AS DOCUMENT_ID, \
			NULL AS ACTIVITY_CODE, NULL AS SERIES_ID, NULL AS ORD_REF_LINE_SEQ, NULL AS TAX_LINE_ITEM, NULL AS CUST_EXEMPT_ID, NULL AS AMOUNT_ACTION, NULL AS AMOUNT, \
			NULL AS PROMOTION_ID, NULL AS REASON_CODE_COMMENT, NULL AS COUPON_SCAN_CODE, NULL AS LOYALTY_CARD_NO, TN.TENDER_ID AS TENDER_ID, \
			TN.TENDER_AMT AS TENDER_AMT, TN.SERIAL_NUMBER AS SERIAL_NUMBER, TN.TENDER_STATUS_CODE AS TENDER_STATUS_CODE, TN.CHANGE_FLAG AS CHANGE_FLAG, \
			TN.HOST_VALIDATION_FLAG AS HOST_VALIDATION_FLAG, TN.APPROVAl_CODE AS APPROVAl_CODE, TN.ADJUDICATION_CODE AS ADJUDICATION_CODE, \
			TN.FOREIGN_AMOUNT AS FOREIGN_AMOUNT, TN.FACE_VALUE_AMT AS FACE_VALUE_AMT, TN.EXPIRY_DATE AS EXPIRY_DATE, TN.UNSPENT_BAL_AMT AS UNSPENT_BAL_AMT, \
			TN.DATE_SOLD AS DATE_SOLD, TN.ACCT_USER_NAME AS ACCT_USER_NAME, TN.TENDER_TYPE AS TENDER_TYPE \
		FROM XHUB_STG_POS_TENDER_LINEITEM TN, XHUB_STG_POS_TRANS_HEADER H \
		WHERE ((H.STG_POS_STATUS = 0 AND H.STG_POS_PROCESS_DATE IS NULL) OR (H.STG_POS_STATUS = 2 AND H.STG_POS_PROCESS_DATE IS NOT NULL)) \
		AND TN.STG_HEADER_ID = H.STG_HEADER_ID 	AND H.ORGANIZATION_ID=?	\
	) T \
	ORDER BY STG_HEADER_ID		
	

	

# Writer Configuration	
xhub.webTransaction.xmlfileprefix=web-transactions
xhub.webTransaction.mntfileprefix=web-transactions-xcenter


# Dao Class Configuration
webTransactionStgDbToFileJob.xhubWebTransactionDao.class=com.skillnet.retail.xhub.dao.mssql.WebTransactionMssqlImpDao

