############################
## Vendor Configuration
 ############################
 
#Job File Name Configuration
storehub.job-file-name=VendorStgDBToMntFile.xml
 
#Reader Configuration 
xhub.vendor.querytimeout=5400
														
vendorStgDBToMntFileJob.vendorPartitioner.table=\
	(SELECT ORGANIZATION_ID,ORG_CD,ORG_VALUE,STG_POS_PROCESS_DATE,STG_POS_STATUS \
	FROM XHUB_STG_VENDOR WITH (NOLOCK) \
	GROUP BY ORGANIZATION_ID,ORG_CD,ORG_VALUE,STG_POS_PROCESS_DATE,STG_POS_STATUS) VENDOR
	
vendorStgDBToMntFileJob.simVendorReader.table=\
	SELECT MESSAGE_TYPE, TRANSACTION_TYPE, SUPPLIER_ID, SUPPLIER_END_DATE_ACTV, SUPPLIER_RET_AUTH_REQ, SUPPLIER_NAME, CURRENCY_CODE, SUPPLIER_DUNS_NUMBER, \
		SUPPLIER_RET_ALLOW_IND, SUPPLIER_STATUS, SUPPLIER_VC_IND, SUPPLIER_VC_PCT, SUPPLIER_DSD_IND, SUPPLIER_PARENT_ID, SUPPLIER_QTY_LEVEL, \
		UPPER(SUPPLIER_MODULE) SUPPLIER_MODULE, SUPPLIER_ADDR_TYPE, PRIMARY_ADDR_IND, SUPPLIER_PHONE, SUPPLIER_FAX, SUPPLIER_ADD1, SUPPLIER_ADD2, SUPPLIER_ADD3, \
		SUPPLIER_COUNTRY_ID,  SUPPLIER_CITY, SUPPLIER_POST, SUPPLIER_STATE, SUPPLIER_CONTACT_NAME, SUPPLIER_CONTACT_EMAIL, ORGANIZATION_ID, SUPPLIER_PRIMARY_PAYSITE_IND, \
		STG_EVENT_ID, STG_SIM_STATUS, STG_SIM_ERROR_MESSAGE, STG_LOAD_DATE, STG_SIM_PROCESS_DATE \
	FROM XHUB_STG_VENDOR WITH (NOLOCK)  \
	WHERE ((STG_SIM_PROCESS_DATE IS NULL AND STG_SIM_STATUS='0') OR (STG_SIM_PROCESS_DATE IS NOT NULL AND STG_SIM_STATUS='2'))
	
vendorStgDBToMntFileJob.vendorDBReader.sql=\
	SELECT  MESSAGE_TYPE ,TRANSACTION_TYPE ,ORGANIZATION_ID ,SUPPLIER_ID ,SUPPLIER_NAME ,SUPPLIER_TYPECODE ,SUPPLIER_STATUS ,SUPPLIER_RET_ALLOW_IND ,SUPPLIER_END_DATE_ACTV ,\
		CURRENCY_CODE ,SUPPLIER_DUNS_NUMBER ,SUPPLIER_VC_IND ,SUPPLIER_VC_PCT ,SUPPLIER_RET_AUTH_REQ ,SUPPLIER_DSD_IND ,SUPPLIER_QTY_LEVEL ,SUPPLIER_MODULE ,\
		SUPPLIER_ADDR_TYPE ,PRIMARY_ADDR_IND ,SUPPLIER_PRIMARY_PAYSITE_IND ,SUPPLIER_CONTACT_EMAIL ,SUPPLIER_COUNTRY_ID ,SUPPLIER_PARENT_ID ,SUPPLIER_ADD1 ,SUPPLIER_ADD2 ,\
		SUPPLIER_ADD3 ,SUPPLIER_ADD4 ,SUPPLIER_STATE ,SUPPLIER_CITY ,SUPPLIER_COUNTRY ,SUPPLIER_PHONE ,SUPPLIER_FAX ,SUPPLIER_POST ,SUPPLIER_CONTACT_PHONE ,\
		SUPPLIER_CONTACT_NAME ,SUPPLIER_BUYER,NEIGHBORHOOD,COUNTY,ORG_VALUE,ORG_CD,STG_POS_RUN_ID ,STG_EVENT_ID \
	FROM XHUB_STG_VENDOR WITH (NOLOCK) \
	WHERE ((STG_POS_PROCESS_DATE is NULL AND STG_POS_STATUS='0') or (STG_POS_PROCESS_DATE IS NOT NULL AND STG_POS_STATUS='2')) \
		AND ORGANIZATION_ID=? AND ORG_CD=? AND ORG_VALUE=? \
	ORDER BY STG_EVENT_ID
	
	

# Writer Configuration	
xhub.vendor.fileprefix=vendor


# Dao Class Configuration
vendorStgDBToMntFileJob.xhubVendorDao.class=com.skillnet.retail.xhub.dao.mssql.VendorMssqlImpDao

